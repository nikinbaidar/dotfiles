#! /usr/bin/env python3

import sys
import pathlib
import lz4.block
import json

path = pathlib.Path.home().joinpath('.mozilla/firefox')
files = path.glob('*default*/sessionstore-backups/recovery.jsonlz4')

for f in files:
    b = f.read_bytes()
    if b[:8] == b'mozLz40\0':
        b = lz4.block.decompress(b[8:])
    j = json.loads(b)
    for window in j['windows']:
        url_list = [ tab['entries'][tab['index'] - 1]['url'] \
                for tab in window['tabs'] ]

localFileCount = 0

for i in range(len(url_list)):
    if url_list[i].startswith("file:///"):
        localFileCount = localFileCount + 1
        localFileIndex = i + 1
        break
    else:
        localFileIndex = -1

print (localFileIndex)


